"use client"; import React, { useEffect, useState } from "react"; import Link from "next/link"; import { usePathname } from "next/navigation"; import { ChevronLeft, List } from "lucide-react"; interface Heading { id: string; text: string; level: number; } const TableOfContents = ({ content }: { content: string }) => { const [headings, setHeadings] = useState<Heading[]>([]); const [isOpen, setIsOpen] = useState<boolean>(false); const pathname = usePathname(); useEffect(() => { if (!content) return; const tempDiv = document.createElement("div"); tempDiv.innerHTML = content; const headingElements = tempDiv.querySelectorAll("h2, h3"); const headingsData: Heading[] = Array.from(headingElements).map((heading) => { const text = heading.textContent?.replace(/[^\w\s]/g, "") || ""; const id = text.toLowerCase().replace(/[^a-z0-9]+/g, "-").replace(/(^-|-$)/g, ""); heading.id = id; return { id, text, level: parseInt(heading.tagName[1]), }; }); setHeadings(headingsData); const contentDiv = document.querySelector(".tiptap"); if (contentDiv) { const contentHeadings = contentDiv.querySelectorAll("h2, h3"); contentHeadings.forEach((heading, index) => { heading.id = headingsData[index]?.id || ""; }); } }, [content]); return (<><button onClick={() => setIsOpen(!isOpen)} className={`fixed z-40 top-24 left-4 md:left-8 p-2 rounded-full bg-white dark:bg-gray-800 shadow-md border border-gray-300 dark:border-gray-700 transition-transform duration-300 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 ${isOpen ? "translate-x-[280px]" : ""}`} aria-label={isOpen ? "Close table of contents" : "Open table of contents"}>{isOpen ? (<ChevronLeft className="w-5 h-5 text-gray-700 dark:text-gray-300" />) : (<List className="w-5 h-5 text-gray-700 dark:text-gray-300" />)}</button><aside className={`fixed z-30 top-0 left-0 h-full w-72 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 shadow-lg transition-transform duration-300 ease-in-out rounded-r-xl overflow-hidden ${isOpen ? "translate-x-0" : "-translate-x-full"}`}><div className="h-full overflow-y-auto p-6"><div className="flex items-center justify-between mb-6"><h2 className="text-xl font-semibold text-gray-800 dark:text-white">Table of Contents</h2><button onClick={() => setIsOpen(false)} className="p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-500" aria-label="Close table of contents"><ChevronLeft className="w-5 h-5 text-gray-500 dark:text-gray-400" /></button></div><nav className="space-y-1">{headings.map((heading, index) => (<Link key={index} href={`${pathname}#${heading.id}`} className={`block py-2 px-3 rounded-md transition-colors duration-200 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer ${heading.level === 2 ? "font-medium text-gray-800 dark:text-gray-200" : "text-gray-600 dark:text-gray-400 ml-4"}`} onClick={(e) => { e.preventDefault(); setIsOpen(false); document.getElementById(heading.id)?.scrollIntoView({ behavior: "smooth" }); window.history.pushState(null, "", `${pathname}#${heading.id}`); }}>{heading.text}</Link>))}</nav></div></aside>{isOpen && (<div className="fixed inset-0 z-20 bg-black bg-opacity-40 lg:hidden" onClick={() => setIsOpen(false)} />)}</>); }; export default TableOfContents;